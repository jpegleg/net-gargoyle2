#!/usr/bin/env bash
mkdir -p /opt/net-gargoyle/workspace/ 2>/dev/null
cp net_mon.py /opt/net-gargoyle/workspace/
cp net_set.py /opt/net-gargoyle/workspace/
cp net_check.py /opt/net-gargoyle/workspace/
cp net_gargoyle.py /opt/net-gargoyle/workspace/
cp net-gargoyle.service /opt/net-gargoyle/workspace/
cp net-gargoyle /usr/local/sbin/
cp reportIps /usr/local/sbin
cp kill-ngr /usr/local/sbin/
chmod +x /usr/local/sbin/kill-ngr
chmod +x /usr/local/sbin/reportIps
chmod +x /usr/local/sbin/net-gargoyle
cp requirements.txt /opt/net-gargoyle/workspace/
cd /opt/net-gargoyle/workspace
python3 -m venv ngvenv
source ngvenv/bin/activate
pip3 install -r requirements.txt
ls gargoyle.db || python3 net_set.py
cp net-gargoyle.service /usr/lib/systemd/system/net-gargoyle.service
systemctl enable net-gargoyle && rm -f net-gargoyle.service install
